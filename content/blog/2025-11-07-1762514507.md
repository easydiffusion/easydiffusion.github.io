---
title: "Post from Nov 07, 2025"
date: 2025-11-07T11:21:47
slug: "1762514507"
tags:
  - ml
  - compiler
  - onnx
  - ggml
  - sdkit
  - worklog
---

Wrote a simple script to convert ONNX to GGML. It auto-generates C++ code that calls the corresponding ggml functions (for each ONNX operator). This file can then be compiled and run like a normal C++ ggml program, and will produce the same results as the original model in PyTorch.

The generated file can work on multiple backends: CPU, CUDA, ROCm, Vulkan, Metal etc, by providing the correct compiler flags during `cmake -B`, e.g. `-D GGML_CUDA=1` for CUDA.

The original PyTorch model was:

```py
class TinyCNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv = nn.Conv2d(3, 8, 3, stride=1, padding=1)
        self.relu = nn.ReLU()
        self.pool = nn.AdaptiveAvgPool2d((1, 1))
        self.fc = nn.Linear(8, 4)  # 4-class toy output

    def forward(self, x):
        x = self.relu(self.conv(x))
        x = self.pool(x).flatten(1)
        return self.fc(x)
```

Repo: [https://github.com/cmdr2/graph-compiler](https://github.com/cmdr2/graph-compiler)

I've currently got it to work for a TinyCNN model, and will add more operators as I make it convert larger models.